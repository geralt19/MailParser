# IMAP Email Call Log Parser & Metadata Extractor

–≠—Ç–æ—Ç Python-—Å–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ø–æ—á—Ç–æ–≤–æ–º—É —è—â–∏–∫—É –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É IMAP, –ø–æ–∏—Å–∫–∞ –ø–∏—Å–µ–º —Å –∑–∞–ø–∏—Å—è–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MP3 –æ—Ç MangoOffice –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ–ª–∞ –ø–∏—Å—å–º–∞ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ SpeechSense. –°–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∞—É–¥–∏–æ—Ñ–∞–π–ª—ã –∏ –∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–æ–∫–∞–ª—å–Ω—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ IMAP:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ IMAP-—Å–µ—Ä–≤–µ—Ä—É (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç SSL).
*   **–ü–æ–∏—Å–∫ –ø–∏—Å–µ–º:** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–∏—Å–µ–º –ø–æ –¥–∞—Ç–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–∏—Å—å–º–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å).
*   **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–∏–π:** –ó–∞–≥—Ä—É–∑–∫–∞ MP3-—Ñ–∞–π–ª–æ–≤ –∏–∑ –≤–ª–æ–∂–µ–Ω–∏–π –ø–∏—Å–µ–º.
*   **–ü–∞—Ä—Å–∏–Ω–≥ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:**
    *   –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ID –∑–≤–æ–Ω–∫–∞ –∏–∑ –∏–º–µ–Ω–∏ MP3-—Ñ–∞–π–ª–∞.
    *   –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ —Ç–µ–ª–∞ –ø–∏—Å—å–º–∞: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–ø–µ—Ä–∞—Ç–æ—Ä–µ, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–≤–æ–Ω–∫–∞ —Å –ø–æ–º–æ—â—å—é —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π.
    *   –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–≤–æ–Ω–∫–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç).
*   **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
    *   –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∑–≤–æ–Ω–∫–∞ (MP3 –∏ JSON —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏) –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É, –Ω–∞–∑–≤–∞–Ω–Ω—É—é ID –∑–≤–æ–Ω–∫–∞.
    *   –ü–∞–ø–∫–∏ —Å ID –∑–≤–æ–Ω–∫–æ–≤ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –¥–∞—Ç–µ (`–î–î.–ú–ú.–ì–ì–ì–ì`).
*   **–§–æ—Ä–º–∞—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON (`metadata.json`) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–≤–æ–Ω–∫–∞.
*   **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** –ü—Ä–æ–ø—É—Å–∫ –∑–≤–æ–Ω–∫–æ–≤ –∫–æ—Ä–æ—á–µ –∑–∞–¥–∞–Ω–Ω–æ–π –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
*   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–æ–∫:** –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–∏—Å–µ–º.

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–∫—Ä–∏–ø—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –∫–æ–¥–µ (`parser.py`):

```python
IMAP_SERVER = 'imap.mail.ru'  # –í–∞—à IMAP-—Å–µ—Ä–≤–µ—Ä
EMAIL_ACCOUNT = 'your_email@example.com'  # –í–∞—à email-–∞–¥—Ä–µ—Å
APP_PASSWORD = 'your_app_password'  # –ü–∞—Ä–æ–ª—å –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–í–ê–ñ–ù–û: –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä–æ–ª—å –æ—Ç –ø–æ—á—Ç—ã!)
DOWNLOAD_FOLDER = 'downloaded_calls'  # –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤
MAILBOX_FOLDER = 'Calls'  # –ü–∞–ø–∫–∞ –≤ –ø–æ—á—Ç–æ–≤–æ–º —è—â–∏–∫–µ, –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–∏—Å—å–º–∞ —Å–æ –∑–≤–æ–Ω–∫–∞–º–∏
METADATA_FILENAME = 'metadata.json' # –ò–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
MIN_CALL_DURATION_SECONDS = 15 # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–≤–æ–Ω–∫–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
```
–í–∞–∂–Ω–æ: –î–ª—è APP_PASSWORD –Ω–µ–æ–±—Ö–æ–¥–∏–º –≤–Ω–µ—à–Ω–∏–π –ø–∞—Ä–æ–ª—å.

## üõ†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
*   **Python 3.x**

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```
<DOWNLOAD_FOLDER>/
‚îî‚îÄ‚îÄ DD.MM.YYYY/                 # –ü–∞–ø–∫–∞ —Å –¥–∞—Ç–æ–π –∑–≤–æ–Ω–∫–∞
    ‚îú‚îÄ‚îÄ <call_id_1>/            # –ü–∞–ø–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞ (–∏–º—è - ID –∑–≤–æ–Ω–∫–∞)
    ‚îÇ   ‚îú‚îÄ‚îÄ <call_id_1>.mp3     # –ê—É–¥–∏–æ—Ñ–∞–π–ª –∑–≤–æ–Ω–∫–∞
    ‚îÇ   ‚îî‚îÄ‚îÄ metadata.json       # –§–∞–π–ª —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –∑–≤–æ–Ω–∫–∞
    ‚îú‚îÄ‚îÄ <call_id_2>/
    ‚îÇ   ‚îú‚îÄ‚îÄ <call_id_2>.mp3
    ‚îÇ   ‚îî‚îÄ‚îÄ metadata.json
    ...
```
   **–ü—Ä–∏–º–µ—Ä metadata.json:**
```
{
    "call_id": "16430220",
    "call_date_folder": "21.07.2024",
    "date": "2024-07-21T12:30:45.000",
    "client_name": "client",
    "direction_outgoing": true,
    "language": "Ru-ru",
    "operator_name": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "operator_id": "–ò–≤–∞–Ω–æ–≤_–ò–≤–∞–Ω_–ò–≤–∞–Ω–æ–≤–∏—á",
    "client_id": "+79001234567",
    "call_duration_parsed_sec": 135,
    "call_duration_original_str": "2 –º–∏–Ω. 15 —Å–µ–∫."
}
```
